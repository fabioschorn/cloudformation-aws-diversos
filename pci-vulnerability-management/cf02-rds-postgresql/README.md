# PCI Vulnerability Management: RDS PostgreSQL Setup

This CloudFormation template provisions an Amazon RDS PostgreSQL database to store and manage parsed vulnerability data, facilitating efficient querying and analysis.

## Architecture Overview

- **Amazon RDS PostgreSQL Instance**: A managed relational database service that handles routine database tasks such as provisioning, patching, backup, recovery, and scaling.

## Resources Created

1. **RDS PostgreSQL Database (`VMAnalysisDB`)**:
   - **DB Instance Class**: `db.c6gd.medium` (1 vCPUs - Graviton2, 2 GB RAM)
   - **Engine Version**: PostgreSQL 17.2
   - **Allocated Storage**: `20 GB` (General Purpose SSD)
   - **Master Username**: `postgres`
   - **Multi-AZ Deployment**: Disabled (suitable for development and testing environments)
   - **Storage Type**: `gp2` (General Purpose SSD)
   - **VPC Security Groups**: Configured to control inbound and outbound traffic to the database instance
   - **DB Subnet Group**: Specifies the subnets and Availability Zones for the RDS instance

## Deployment Instructions

1. **Prepare the Network Environment**:
   - Ensure that the VPC has private subnets where the RDS instance will be deployed.
   - Check that the Lambda function will be in the same VPC or has a proper route to access the database.

2. **Deploy the CloudFormation Template**:
   - Use the AWS Management Console, AWS CLI, or any Infrastructure as Code (IaC) tool that supports CloudFormation to deploy the template.

3. **Configure Security Groups**:
   - Ensure that the RDS instance security group allows inbound traffic from the Lambda function or EC2 instances that need to access the database.

4. **Initialize the Database**:
   - After deployment, connect to the RDS instance using `psql` or a database client.
   - Create the necessary tables and schemas for storing the vulnerability data.

## Notes

- **Instance Class**: The template uses `db.c6gd.medium`, which is suitable for development and testing environments. For production workloads, consider using a larger instance class.
- **Storage Scaling**: The allocated storage is set to `20 GB`. Monitor storage usage and adjust as necessary based on data growth.
- **Security**: Ensure that database credentials are stored securely, such as in AWS Secrets Manager, and that access to the database is restricted to authorized entities only.
- **Backups**: Configure automated backups and snapshots as needed to meet your data protection requirements.